<head>
	<script type="text/javascript" src = "data.js"></script>
	<script type="text/javascript" src = "../../src/linked-charts.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/igv@2.15.5/dist/igv.min.js"></script>
	<link rel="stylesheet" type="text/css" href="../../src/linked-charts.css">
</head>
<body>
<div id = "ma-expr">
<table>
   <tr>
      <td id = "ma"></td>
      <td id = "igv"></td>
   </tr>
</table>
</div>	
	<script type="text/javascript">

var selGene = 0,
	size = window.innerWidth,
	igvBrowser;

var maPlot = lc.scatter()
	.x(i => maData[i].AveExpr)
	.y(i => maData[i].tissuetumour)
	.colour(i => maData[i]["adj.P.Val"] < 0.1 ? "red" : "black")
	.label(i => maData[i].geneNames)
	.size(1.3)
	.on_click(i => {igvBrowser.search(maData[i].geneNames)})
	.width(() => (size - 100) * 0.48)
	.height(() => (size - 100) * 0.48)
	.set_paddings({left: 15})
	.place(d3.select("#ma-expr").select("#ma"));

window.addEventListener("resize", () => {
	size = window.innerWidth;
	maPlot.update();
})

document.addEventListener("DOMContentLoaded", function () {
	var div = document.getElementById("igv");
   var options = {
   	locus: "TSPAN6",       // OPTIONAL, open at a specific location
      genome: "hg38"
   };
   igv.createBrowser(div, options)
		.then(function (b) {
      	igvBrowser = b;
      
		   var site = "https://papagei.bioquant.uni-heidelberg.de/sveta/oscc_bam/",
		   	samples = ["PG079_dysplasia", "PG079_normal", "PG079_tumour"],
		   	trackConfigs = samples.map(s => ({
		   		name: s, 
		   		type: "alignment", 
		   		format: "bam", 
		   		height: 150,  
		   		url: site + s + ".bam", 
		   		indexURL: site + s + ".bam.bai"
		   	}));

		   igvBrowser.loadTrackList(trackConfigs);
      })
})

	</script>
</body>